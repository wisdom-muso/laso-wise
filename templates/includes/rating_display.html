<!-- Enhanced Rating Display Component -->
<div class="rating-display">
    {% if doctor.reviews_received.exists %}
        <div class="rating-summary">
            <div class="rating-score">
                <span class="rating-number">{{ doctor.average_rating|floatformat:1 }}</span>
                <div class="rating-stars">
                    {% for i in "12345" %}
                        {% if forloop.counter <= doctor.average_rating|floatformat:0 %}
                            <i class="fas fa-star text-warning"></i>
                        {% elif forloop.counter == doctor.average_rating|add:1|floatformat:0 and doctor.average_rating|floatformat:1|add:0 > forloop.counter|add:-1 %}
                            <i class="fas fa-star-half-alt text-warning"></i>
                        {% else %}
                            <i class="far fa-star text-muted"></i>
                        {% endif %}
                    {% endfor %}
                </div>
                <span class="rating-count text-muted">({{ doctor.rating_count }} review{{ doctor.rating_count|pluralize }})</span>
            </div>
        </div>
        
        <!-- Detailed Rating Breakdown -->
        <div class="rating-breakdown mt-3">
            {% for rating, count in doctor.rating_distribution.items %}
                <div class="rating-row d-flex align-items-center mb-1">
                    <span class="rating-label">{{ rating }} star{{ rating|pluralize }}</span>
                    <div class="rating-bar mx-2 flex-grow-1">
                        <div class="progress" style="height: 8px;">
                            <div class="progress-bar bg-warning" 
                                 style="width: {% if doctor.rating_count > 0 %}{{ count|mul:100|div:doctor.rating_count }}{% else %}0{% endif %}%"></div>
                        </div>
                    </div>
                    <span class="rating-count-small text-muted">{{ count }}</span>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="no-ratings text-center py-3">
            <div class="rating-stars mb-2">
                {% for i in "12345" %}
                    <i class="far fa-star text-muted"></i>
                {% endfor %}
            </div>
            <p class="text-muted mb-0">No reviews yet</p>
            <small class="text-muted">Be the first to review this doctor</small>
        </div>
    {% endif %}
</div>

<style>
.rating-display {
    background: #f8f9fa;
    border-radius: 0.75rem;
    padding: 1rem;
    margin: 1rem 0;
}

.rating-score {
    text-align: center;
    margin-bottom: 1rem;
}

.rating-number {
    font-size: 2.5rem;
    font-weight: 700;
    color: #ffc107;
    display: block;
    line-height: 1;
}

.rating-stars {
    font-size: 1.2rem;
    margin: 0.5rem 0;
}

.rating-count {
    font-size: 0.9rem;
}

.rating-breakdown .rating-row {
    font-size: 0.85rem;
}

.rating-label {
    min-width: 60px;
    font-size: 0.8rem;
}

.rating-bar {
    height: 8px;
}

.rating-count-small {
    min-width: 20px;
    text-align: right;
    font-size: 0.75rem;
}

.no-ratings {
    opacity: 0.7;
}
</style>